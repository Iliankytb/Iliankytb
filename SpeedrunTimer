-- Créer le ScreenGui
local player = game.Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")
local character = player.Character or player.CharacterAdded:Wait() -- Attendre que le personnage soit disponible
local humanoid = character:WaitForChild("Humanoid") -- Accéder à l'humanoïde du joueur

-- Supprimer l'ancien TimerGui s'il existe
local existingGui = playerGui:FindFirstChild("TimerGui")
if existingGui then
    existingGui:Destroy()
end

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "TimerGui"
screenGui.Parent = playerGui -- Assurez-vous que cela se trouve dans le PlayerGui

-- Créer le TextLabel pour le timer
local timerLabel = Instance.new("TextLabel")
timerLabel.Name = "TimerLabel"
timerLabel.Size = UDim2.new(0, 200, 0, 50) -- Largeur et hauteur du label
timerLabel.Position = UDim2.new(0, 0, 0.2, -25) -- Centré horizontalement
timerLabel.Text = "00:00"
timerLabel.TextScaled = true -- Pour ajuster le texte à la taille du label
timerLabel.BackgroundColor3 = Color3.fromRGB(0, 0, 0) -- Couleur de fond noir
timerLabel.TextColor3 = Color3.fromRGB(255, 255, 255) -- Couleur du texte blanc
timerLabel.Parent = screenGui

local ByIlianLabel = Instance.new("TextLabel")
ByIlianLabel.Name = "ByIlian"
ByIlianLabel.Size = UDim2.new(0, 200, 0,25) -- Largeur et hauteur du label
ByIlianLabel.Position = UDim2.new(0, 0, 0.3, -25) -- Centré horizontalement
ByIlianLabel.Text = "Created By Iliankytb"
ByIlianLabel.TextScaled = true -- Pour ajuster le texte à la taille du label
ByIlianLabel.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
ByIlianLabel.BackgroundTransparency = 1 -- Couleur de fond noir
ByIlianLabel.TextColor3 = Color3.fromRGB(255, 255, 255) -- Couleur du texte blanc
ByIlianLabel.Parent = screenGui


-- Créer le bouton pour arrêter le timer
local stopButton = Instance.new("TextButton")
stopButton.Name = "StopButton"
stopButton.Size = UDim2.new(0, 200, 0, 50) -- Largeur et hauteur du bouton
stopButton.Position = UDim2.new(0, 0, 0.3, 0) -- Centré horizontalement
stopButton.Text = "Stop The Timer"
stopButton.TextScaled = true -- Pour ajuster le texte à la taille du bouton
stopButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0) -- Couleur de fond rouge
stopButton.TextColor3 = Color3.fromRGB(255, 255, 255) -- Couleur du texte blanc
stopButton.Parent = screenGui

local RemoveGuiButton = Instance.new("TextButton")
RemoveGuiButton.Name = "RemoveTimerGui"
RemoveGuiButton.Size = UDim2.new(0, 200, 0, 50) -- Largeur et hauteur du bouton
RemoveGuiButton.Position = UDim2.new(0, 0, 0.45, 0) -- Centré horizontalement
RemoveGuiButton.Text = "Remove Timer"
RemoveGuiButton.TextScaled = true -- Pour ajuster le texte à la taille du bouton
RemoveGuiButton.BackgroundColor3 = Color3.fromRGB(255, 255, 0) -- Couleur de fond rouge
RemoveGuiButton.TextColor3 = Color3.fromRGB(255, 255, 255) -- Couleur du texte blanc
RemoveGuiButton.Parent = screenGui

-- Variables pour le timer
local running = true -- Le timer démarre automatiquement
local minutes = 0
local seconds = 0

-- Fonction pour formater le temps sous la forme MM:SS
local function formatTime(mins, secs)
    return string.format("%02d:%02d", mins, secs)
end

-- Fonction pour mettre à jour l'affichage du timer
local function updateTimer()
    while running do
        wait(1)
        seconds = seconds + 1
        
        -- Si les secondes atteignent 60, on incrémente les minutes
        if seconds >= 60 then
            seconds = 0
            minutes = minutes + 1
        end

        -- Mettre à jour le label avec le temps formaté
        timerLabel.Text = formatTime(minutes, seconds)
    end
end

-- Fonction pour stopper le timer
local function stopTimer()
    running = false
seconds = seconds -1
    stopButton.Text = "Timer Stopped!"
end

local function RemoveUi()
    playerGui:FindFirstChild("TimerGui"):Destroy()
    script:Destroy()
end

-- Fonction pour arrêter le timer si le joueur meurt

-- Connexion de l'événement de mort de l'humanoïde
humanoid.Died:Connect(stopTimer)

-- Lancer la fonction de mise à jour du timer dans un thread séparé
spawn(updateTimer)

-- Connexion du bouton à l'arrêt du timer
stopButton.MouseButton1Click:Connect(stopTimer)

RemoveGuiButton.MouseButton1Click:Connect(RemoveUi)
